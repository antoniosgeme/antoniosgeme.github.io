---
title: "Visualizing Potential Flows"
date: 2023-11-30
permalink: /posts/2023/11/blog-post-1/
tags:
  - Aerodynamics
  - Potential Flow
  - Conformal Mapping
---

<button id="toggle-position-btn">Toggle Position</button>



Welcome to my first blog post! I want to use this platform to share some thoughts or technical material that I find useful and I don't think are taught often. I would also like to make it as interactive as possible. Unfortunately, this website is jekyll based and so it is *static*, meaning that all its code is generated before you click on this page. Thus, interactivity is not really possible in the traditional sense but that does not stop us from building the interactivity on another platform and then embedding here. I will be using [observableHQ](https://observablehq.com/) notebooks. They are lots of fun. 


### Preliminaries
In this post we will create a basic potential flow and conformal map interactive visualization. The flows will be rendered using WebGL in a [observableHQ](https://observablehq.com/) notebook, following the approaches of [Ricky Reusser](https://observablehq.com/@rreusser/adaptive-domain-coloring) and [Graham Pullam](https://observablehq.com/@grahampullan/joukowski-airfoils). It is totally possible to create real-time interactive visualizations like this using python or matlab. However, these tools often overburden the graphics and the visualizations end up being sluggish. WebGL allows to render high-performance interactive 2D and 3D graphics by efficiently exploiting our system's graphics capabilities (CPU or GPU). The price we pay is having to use JavaScript. In my opinion, the end result are totally worth the effort. 

### Potential Flow
A flow is called potential if its velocity field can be written as the gradient of a scalar potential, $ \mathbf{u} = \nabla \phi$. The incompresilbity condition of a fluid, $\nabla \cdot \mathbf{u}= 0$ also implies that the scalar potential satisfies Laplace's equation $\nabla^2 \phi = 0$. The good news is that we know *a lot* about the solutions of Laplace's equations. Its linearity also allows us to construct solutions by taking linear combinations of other solutions. We will be working with three of the **fundamental solutions** solutions to Laplace's equation: 1) uniform flow, 2) point vortex flow, 3) doublet flow. A uniform flow is characterized by its freestream velocity, $U_{\infty}$, and its flow angle, $\alpha$. A point vortex flow is characterized by its circulation, $\Gamma$, and a doublet flow is characterized by its doublet strength, $\kappa$, and (for simplicity) the same flow angle, $\alpha$. The complex velocity induced by each of these flows are, 

$$
\begin{equation}
W_{U} = U_{\infty} e^{-i\alpha} \;\;\;\;\;\;\;\;
W_{V} = \frac{i \Gamma}{2\pi \zeta} \;\;\;\;\;\;\;\;
W_{D} = -\frac{\kappa}{\zeta^2}e^{i\alpha}
\end{equation}
$$

where $\zeta \in \mathbb{C}$ is the position in complex space. The interactive plot below plots the streamlines as well as the pressure field induced by each of the above flows. The dropdown menu allows you to toggle between the different flows as well as their linear combinations. The coefficients can be adjusted using the sliders next to the plot. 

<style>
    #wrapper {
      /* Add height to ensure there's enough scrollable content */
      height: 1000px; /* You can adjust this height as needed */
    }

    #plot-options-container {
      display: flex;
      align-items: flex-start;
      position: sticky;
      top: 0; /* Stick to the top of the viewport */
      background-color: white; /* Adjust the background color as needed */
      z-index: 1; /* Add z-index to ensure it appears above other content */
    }

    #plot-container {
      flex: 1;
    }

    #options-container {
      flex: 1;
      margin-left: 10px;
    }
    
    #shift-slider-container {
      display: flex;
      justify-content: space-between; /* To space the sliders evenly */
    }

    #slider-container {
    display: flex;
} 
  #slider {
      flex: 0 0 auto; /* Prevents the div from growing to fill available space */
      width: 50%; /* Set width to half of the container */
      margin-right: 10px; /* Adjust margin as needed */
      border: 1px solid #ccc; /* Optional: Add border for visualization */
  }
  </style>

<div id="plot-options-container" style="display: flex; align-items: flex-start;">
  <div id="plot-container" style="flex: 1;">
    <div id="observablehq-viewof-gl-5d8905d6"></div>
  </div>
  <div id="options-container" style="flex: 1; margin-left: 10px;"> 
    <div id="observablehq-viewof-flowSelection-5d8905d6"></div>
    <div id="observablehq-viewof-alpha_deg-5d8905d6"></div>
    <div id="observablehq-viewof-U-5d8905d6"></div>
    <div id="observablehq-viewof-Gamma-5d8905d6"></div>
    <div id="observablehq-viewof-Kappa-5d8905d6"></div>
    <div id="observablehq-viewof-options-5d8905d6"></div>
  </div>
</div>


### Flow over a cylinder
An interesting flow arises when we add a uniform flow and a doublet. You might have noticed that one of the streamlines for this flow forms a closed circle which varies in size as the freestream velocity and doublet strength change. By definition, the flow velocity is parallel to a streamline and never perpendicular to it. Thus, that circular streamline can be considered to be the boundary of a circular solid body, since no flow can enter it or leave it. We can analytically find the size of the circle and replace the flow inside of it with our body. Its radius ends up being $a = \sqrt{\frac{\kappa}{U}}$. Checking this checkbox addd the body to the plot, if one exists in the flow.  


### Conformal Map
Perhaps the most powerful idea in the theory of potential flows is that of a conformal map. Conformal maps allow us to transform solutions of simple problems to solutions of difficult problems. For example, there exists conformal maps that can take the solution for the flow over the cylinder shown above, to the flow over a body of **any** shape. The caveat is that only simple shapes tend to have analytical conformal maps, while more complicated shapes have to be dealt with numerically using the [Schwarzâ€“Christoffel mapping](https://en.wikipedia.org/wiki/Schwarz%E2%80%93Christoffel_mapping). 

The conformal map of interest to the theory of aerodynamics is the Joukowsky transform. This transform can transform the flow over a cylinder to the flow over some very reasonable looking airfoils! The transform is defined as,

$$
\begin{equation}
  z = \zeta + \frac{1}{\zeta}
\end{equation}
$$

The map takes every point in the $\zeta$-plane to a point in the new z-plane. Checking the box below should apply the transform to the visualization. Play around with how each of the flows gets transformed by this map. 


While the transform does some interesting stuff, the body never really looks like an airfoil. To do that we need to move the center circle away from the origin. The sliders below shif the circle


<div class="slider-container">
    <div class="slider">
        <div id="observablehq-viewof-shift-5d8905d6"></div>
    </div>
    <div class="slider">
        <div id="observablehq-viewof-shift_vertical-5d8905d6"></div>
    </div>
</div>


  <div id="observablehq-KuttaButton-5d8905d6"></div>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css">
<script type="module">
import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";
import define from "https://api.observablehq.com/d/6a13ba7040fa6e52@1769.js?v=4";
new Runtime().module(define, name => {
  if (name === "viewof gl") return new Inspector(document.querySelector("#observablehq-viewof-gl-5d8905d6"));
  if (name === "viewof flowSelection") return new Inspector(document.querySelector("#observablehq-viewof-flowSelection-5d8905d6"));
  if (name === "viewof alpha_deg") return new Inspector(document.querySelector("#observablehq-viewof-alpha_deg-5d8905d6"));
  if (name === "viewof U") return new Inspector(document.querySelector("#observablehq-viewof-U-5d8905d6"));
  if (name === "viewof Gamma") return new Inspector(document.querySelector("#observablehq-viewof-Gamma-5d8905d6"));
  if (name === "viewof Kappa") return new Inspector(document.querySelector("#observablehq-viewof-Kappa-5d8905d6"));
  if (name === "viewof shift") return new Inspector(document.querySelector("#observablehq-viewof-shift-5d8905d6"));
  if (name === "viewof shift_vertical") return new Inspector(document.querySelector("#observablehq-viewof-shift_vertical-5d8905d6"));
  if (name === "viewof options") return new Inspector(document.querySelector("#observablehq-viewof-options-5d8905d6"));
  if (name === "KuttaButton") return new Inspector(document.querySelector("#observablehq-KuttaButton-5d8905d6"));
  return ["programInfo","render","values","radius","x_te","Kutta_circulation","initialGrid","beta","values_uniform","values_vortex","values_doublet","grid","values_uniform_doublet","values_uniform_vortex","values_uniform_vortex_doublet","values_vortex_doublet","alpha","transform","body"].includes(name);
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleBtn = document.getElementById('toggle-position-btn');
    const plotOptionsContainer = document.getElementById('plot-options-container');
    
    toggleBtn.addEventListener('click', function() {
        if (plotOptionsContainer.style.position === 'sticky') {
            plotOptionsContainer.style.position = 'static';
        } else {
            plotOptionsContainer.style.position = 'sticky';
        }
    });
});
</script>